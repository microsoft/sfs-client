# Pipeline to build the SFS Client in Azure Pipelines so it can be scanned in compliance processes.

trigger:
  branches:
    include:
      - main

pr:
  branches:
    include:
      - main

pool:
  vmImage: "windows-2022"

jobs:
- job: Windows Build

    steps:
    - checkout: self

    - template: templates/install-winget.yml
      displayName: Install Winget

    - task: PowerShell@2
      displayName: Setup
      inputs:
        targetType: 'inline'
      run: .\scripts\Setup.ps1 -NoBuildTools

    - task: PowerShell@2
      displayName: Build
      inputs:
        targetType: 'inline'
      run: |
        .\scripts\Build.ps1

    - task: PowerShell@2
      displayName: Test
      inputs:
        targetType: 'inline'
      run: |
        .\scripts\Test.ps1 -OutputOnFailure
